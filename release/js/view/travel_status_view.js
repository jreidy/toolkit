(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["underscore","backbone","util/util","model/user","model/loading","model/location","view/navbar_view","view/loading_view","text!template/travel_status.html"],function(e,n,r,i,s,o,u,a,f){var l;return l=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.el="#main",r.prototype.template=e.template(f),r.prototype.initialize=function(){var t;return e.bindAll(this),this.bindEvents(),this.router=window.EngApp.appRouter,this._preRender(),this.user=new i,this.user.on("change:userName",this.userDataReady),t=new u({model:this.user})},r.prototype.bindEvents=function(){var e,t;return this.$el.undelegate("#save"),e="createTouch"in document?"tap":"click",t={},t[""+e+" #save"]="set",this.delegateEvents(t)},r.prototype._preRender=function(){return this.loadingView=new a({model:new s({message:"rendering travel status page"})}),this.loadingView.render()},r.prototype.userDataReady=function(){return this.loadingView.empty(),this.location=new o,this.location.set("id",this.user.get("email")),this.locationPromise=this.location.fetch(),this.locationPromise.done(this.render)},r.prototype.render=function(){return this.$el.html(this.template(this.location.toJSON()))},r.prototype.set=function(e){var t,n=this;t=this.$el.find("#status").val();if(!t){alert("Travel Status can't be empty");return}return this.location.set({interest:t,last_modify:Date.now()}),this.location.save().done(function(){return n.router.navigate("beacon",{trigger:!0})})},r}(n.View)})}).call(this)