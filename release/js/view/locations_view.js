(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["underscore","backbone","text!template/location.html","view/location_box","view/loading_view"],function(e,n,r,i,s){var o;return o=function(n){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,n),o.prototype.el="#locations",o.prototype.template=e.template(r),o.prototype.initialize=function(){return e.bindAll(this),this.bindEvents(),this._preRender(),this.model.on("reset",this.readyForAction),this.model.fetch()},o.prototype.bindEvents=function(){var e,t;return this.$el.undelegate(".has_status"),e="createTouch"in document?"tap":"click",t={},t[""+e+" .has_status"]="showUserStatus",this.delegateEvents(t)},o.prototype.readyForAction=function(){return this.render(),this.loadingView.empty()},o.prototype.render=function(){return this.items=this.model.toJSON(),this.$el.html(this.template),this.header=document.createElement("H3"),this.header.className="location_header",this.$el.append(this.header),this.name=document.createElement("span"),this.name.className="location_name",this.$el.append(this.name),this.pop=document.createElement("p"),this.pop.className="pop",this.locationBox=new i,this.updateLocationView("0")},o.prototype._preRender=function(){return this.loadingView=new s},o.prototype.showUserStatus=function(e){var t,n;return t=$(e.target),n=t.hasClass("has_status")?t.find(".user_status"):t.parents(".has_status").find(".user_status"),alert($.trim(n.html()))},o.prototype.updateLocationView=function(e){var t,n,r,i,s,o,u,a,f,l;r=document.getElementById("current_location_image");switch(e){case"0":u="2nd St., SF, US";break;case"1":u="CB, SF, US";break;case"2":u="Beijing, CN";break;default:u="Tokyo, JP"}f=0,o="",i=!1;for(n in this.items)this.items[n].current===u&&(f++,l=this.items[n].userName,a="",t=l.indexOf(".",0),s=l.lastIndexOf("."),t===s?(a+=l.substring(0,t),a+=" "+l.substring(t+1,l.length)):(a+=l.substring(t+1,s),a+=" "+l.substring(s+1,l.length)),o+=a+"\n");switch(e){case"0":return r.className="cali_orange",this.header.innerHTML="UNITED STATES",this.name.innerHTML="2ND STREET, SF",this.header.style.marginTop="273px",this.name.style.marginTop="296px",this.header.style.marginLeft="40px",this.name.style.marginLeft="41px",this.locationBox.renderBox(85,164,f,o);case"1":return r.className="cali_purple",this.header.innerHTML="UNITED STATES",this.name.innerHTML="CHINA BASIN, SF",this.header.style.marginTop="273px",this.name.style.marginTop="296px",this.header.style.marginLeft="40px",this.name.style.marginLeft="41px",this.locationBox.renderBox(87,165,f,o);case"2":return r.className="china_blue",this.header.innerHTML="CHINA",this.name.innerHTML="BEIJING",this.header.style.marginTop="293px",this.name.style.marginTop="316px",this.header.style.marginLeft="60px",this.name.style.marginLeft="61px",this.locationBox.renderBox(212,158,f,o);default:return r.className="japan_green",this.header.innerHTML="JAPAN",this.name.innerHTML="TOKYO",this.header.style.marginTop="163px",this.name.style.marginTop="186px",this.header.style.marginLeft="50px",this.name.style.marginLeft="51px",this.locationBox.renderBox(210,234,f,o)}},o}(n.View),o})}).call(this)