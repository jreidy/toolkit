/*
Simply Deferred - v.1.1.2
(c) 2012 Sudhir Jonathan, contact.me@sudhirjonathan.com
Released under the MIT License.
*/

(function(){var e,t,n,r,i,s,o,u,a,f=[].slice;o=(typeof window!="undefined"&&window!==null?window._:void 0)||require("underscore"),t="pending",r="resolved",n="rejected",s=o.flatten,i=function(e,t){var n,r,i,o,u;o=s(e),u=[];for(r=0,i=o.length;r<i;r++)n=o[r],u.push(n.apply(null,t));return u},e=function(){var e,o,u,a,f,l;return l=t,a=[],f=[],e=[],u={},this.promise=function(o){var c;return o=o||{},o.state=function(){return l},c=function(e,n){return function(){return l===t&&n.push.apply(n,s(arguments)),e()&&i(arguments,u),o}},o.done=c(function(){return l===r},a),o.fail=c(function(){return l===n},f),o.always=c(function(){return l!==t},e),o},this.promise(this),o=function(n,r){return function(){return l===t&&(l=n,u=arguments,i([r,e],u)),this}},this.resolve=o(r,a),this.reject=o(n,f),this},a=function(){var t,n,r,i,u,a;i=new e,n=s(arguments),r=o.after(n.length,i.resolve);for(u=0,a=n.length;u<a;u++)t=n[u],t.done(r);return i.promise()},u=function(t){return t.Deferred=function(){return new e},t.ajax=o.wrap(t.ajax,function(t,n){var r,i;return n==null&&(n={}),i=new e,r=function(e,t){return o.wrap(e,function(){var e,n;return n=arguments[0],e=2<=arguments.length?f.call(arguments,1):[],n&&n.apply(null,e),t.apply(null,e)})},n.success=r(n.success,i.resolve),n.error=r(n.error,i.reject),t(n),i.promise()}),t.when=a},typeof exports!="undefined"?(exports.Deferred=function(){return new e},exports.when=a,exports.installInto=u):(this.Deferred=function(){return new e},this.Deferred.when=a,this.Deferred.installInto=u)}).call(this)